<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ­ã‚°ã‚¤ãƒ³ãƒ»æ–°è¦ç™»éŒ² - ãã‚‰ã‚€ã¼ã‚“å…¬å¼ã‚µã‚¤ãƒˆ</title>
    <meta name="description" content="ãã‚‰ã‚€ã¼ã‚“ã®ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ»æ–°è¦ç™»éŒ²ãƒšãƒ¼ã‚¸ã§ã™ã€‚ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¦ã€é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã—ã‚‡ã†ã€‚">
    <meta name="robots" content="noindex">
    <link rel="canonical" href="https://nyankohack.tokyo/ãƒ­ã‚°ã‚¤ãƒ³.html">
    
    <link rel="icon" type="image/png" href="ãƒãƒ£ãƒ³ãƒãƒ«ã‚¢ã‚¤ã‚³ãƒ³.jpg">
    <link rel="apple-touch-icon" sizes="180x180" href="ãƒãƒ£ãƒ³ãƒãƒ«ã‚¢ã‚¤ã‚³ãƒ³.jpg">

    <meta http-equiv="Content-Security-Policy" content="connect-src 'self' https://script.google.com https://script.googleusercontent.com;">
    <style>
        :root { 
            --primary-color: #98FB98; --secondary-color: #2E8B57; --bg-color: #F0FFF0; 
            --widget-bg: #fff; --text-color: #333; --error-color: #d32f2f; 
            --success-color: #2e7d32; --radius: 12px; --shadow: 0 4px 8px rgba(0,0,0,0.1); 
            --border-color: #ccc;
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --primary-color: #2E8B57; --secondary-color: #98FB98; --bg-color: #121212;
                --widget-bg: #1E1E1E; --text-color: #E0E0E0; --error-color: #ff7961;
                --success-color: #81c784; --shadow: 0 4px 8px rgba(0,0,0,0.4);
                --border-color: #555;
            }
        }
        body { font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; }
        main { width: 100%; max-width: 500px; }
        .widget { background-color: var(--widget-bg); padding: 25px 30px; margin-bottom: 25px; border-radius: var(--radius); box-shadow: var(--shadow); border-left: 5px solid var(--secondary-color); box-sizing: border-box; }
        h2 { color: var(--secondary-color); border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; margin-top: 0; text-align: center; margin-bottom: 25px; }
        .input-area { margin-bottom: 20px; }
        .input-area label { display: block; margin-bottom: 8px; font-weight: bold; }
        input[type="text"], input[type="password"] { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 16px; box-sizing: border-box; background-color: var(--widget-bg); color: var(--text-color); }
        .action-btn { display: block; width: 100%; padding: 15px; font-size: 18px; font-weight: bold; color: white; border: none; border-radius: var(--radius); cursor: pointer; transition: background-color 0.3s; margin-top: 10px; background-color: var(--secondary-color); }
        .action-btn:disabled { background-color: #999; cursor: not-allowed; }
        .message-area { text-align: center; font-weight: bold; min-height: 1.2em; margin-top: 15px; }
        .error-message { color: var(--error-color); }
        .success-message { color: var(--success-color); }
        .form-toggle { text-align: center; margin-top: 20px; }
        .toggle-link { color: var(--secondary-color); cursor: pointer; text-decoration: underline; }
        #register-widget { display: none; }
        .top-nav { display: flex; gap: 15px; justify-content: center; align-items: center; flex-wrap: wrap; }
        .nav-btn { display: inline-flex; align-items: center; justify-content: center; min-width: 150px; height: 40px; background-color: var(--secondary-color); color: white; font-weight: bold; text-decoration: none; border-radius: 8px; padding: 0 20px; transition: background-color 0.3s, transform 0.2s; }
        .nav-btn:hover { background-color: #256d45; transform: translateY(-2px); }
        .notice-text { font-size: 0.9em; color: #888; line-height: 1.5; margin-bottom: 20px; text-align: center; }
        .footer-links { text-align: center; margin-top: 15px; font-size: 0.9em; }
        .footer-links a { color: var(--secondary-color); text-decoration: none; margin: 0 10px; }
        .footer-links a:hover { text-decoration: underline; }

        /* â–¼â–¼â–¼ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤ºãƒœã‚¿ãƒ³ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ  â–¼â–¼â–¼ */
        .password-container { position: relative; }
        .toggle-password {
            position: absolute;
            top: 50%;
            right: 12px;
            transform: translateY(-50%);
            cursor: pointer;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
            font-size: 20px;
            color: #888;
        }
    </style>
</head>
<body>
    <main>
        <section class="widget">
            <h2>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h2>
            <nav class="top-nav">
                <a href="index.html" class="nav-btn">ãƒ›ãƒ¼ãƒ </a>
                <a href="é–‹ç™ºè€…ã«ã¤ã„ã¦.html" class="nav-btn">é–‹ç™ºè€…ã«ã¤ã„ã¦</a>
                <a href="Lua_editor.html" class="nav-btn">Lua editor</a>
            </nav>
        </section>

        <section id="login-widget" class="widget">
            <h2>ãƒ­ã‚°ã‚¤ãƒ³</h2>
            <p class="notice-text">
                ã“ã®ã‚µã‚¤ãƒˆã®é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç·¨é›†ãƒšãƒ¼ã‚¸ãªã©ï¼‰ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚<br>
                <strong>â€»Googleã‚„ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã¯ä¸€åˆ‡é–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“ã€‚</strong>
            </p>
            <form id="login-form" action="?">
                <div class="input-area">
                    <label for="login-username">ãƒ¦ãƒ¼ã‚¶ãƒ¼å</label>
                    <input type="text" id="login-username" name="username" autocomplete="username" required>
                </div>
                <div class="input-area">
                    <label for="login-password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
                    <!-- â–¼â–¼â–¼ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤ºãƒœã‚¿ãƒ³ã‚’é…ç½® â–¼â–¼â–¼ -->
                    <div class="password-container">
                        <input type="password" id="login-password" name="password" autocomplete="current-password" required>
                        <span class="toggle-password" id="toggle-login-password">ğŸ‘ï¸</span>
                    </div>
                </div>
                <button type="submit" id="login-btn" class="action-btn">ãƒ­ã‚°ã‚¤ãƒ³</button>
                <p id="login-message" class="message-area error-message"></p>
            </form>
            <div class="form-toggle">
                ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ãªã„ã§ã™ã‹ï¼Ÿ <span id="show-register" class="toggle-link">æ–°è¦ç™»éŒ²</span>
            </div>
            <div class="footer-links">
                <a href="privacy-policy.html" target="_blank">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
                <a href="terms-of-service.html" target="_blank">åˆ©ç”¨è¦ç´„</a>
            </div>
        </section>

        <section id="register-widget" class="widget">
            <h2>æ–°è¦ç™»éŒ²</h2>
            <p class="notice-text">
                ã“ã®ã‚µã‚¤ãƒˆå°‚ç”¨ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æ–°è¦ä½œæˆã—ã¾ã™ã€‚<br>
                ã“ã“ã§ç™»éŒ²ã—ãŸæƒ…å ±ãŒã€ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
            </p>
            <form id="register-form" action="?">
                <div class="input-area">
                    <label for="register-username">ãƒ¦ãƒ¼ã‚¶ãƒ¼å (4ï½32æ–‡å­—)</label>
                    <input type="text" id="register-username" name="new-username" autocomplete="username" required minlength="4" maxlength="32">
                </div>
                <div class="input-area">
                    <label for="register-password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ (8ï½32æ–‡å­—)</label>
                     <!-- â–¼â–¼â–¼ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤ºãƒœã‚¿ãƒ³ã‚’é…ç½® â–¼â–¼â–¼ -->
                    <div class="password-container">
                        <input type="password" id="register-password" name="new-password" autocomplete="new-password" required minlength="8" maxlength="32">
                        <span class="toggle-password" id="toggle-register-password">ğŸ‘ï¸</span>
                    </div>
                </div>
                <button type="submit" id="register-btn" class="action-btn">ç™»éŒ²ã™ã‚‹</button>
                <p id="register-message" class="message-area"></p>
            </form>
            <div class="form-toggle">
                ã™ã§ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ <span id="show-login" class="toggle-link">ãƒ­ã‚°ã‚¤ãƒ³</span>
            </div>
            <div class="footer-links">
                <a href="privacy-policy.html" target="_blank">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
                <a href="terms-of-service.html" target="_blank">åˆ©ç”¨è¦ç´„</a>
            </div>
        </section>
    </main>
    <script>
        const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbynZWcG9kstvsTTSuMjQ_F17xEhkM4yPHF_8Yl93fBe9UrKAAzDYl24SyP6sfkjleqV/exec';
        const LOGGED_IN_PAGE = 'ã«ã‚ƒã‚“ã“å¤§æˆ¦äº‰.html';
        const loginWidget = document.getElementById('login-widget');
        const registerWidget = document.getElementById('register-widget');
        const showRegisterLink = document.getElementById('show-register');
        const showLoginLink = document.getElementById('show-login');
        showRegisterLink.addEventListener('click', () => { loginWidget.style.display = 'none'; registerWidget.style.display = 'block'; });
        showLoginLink.addEventListener('click', () => { registerWidget.style.display = 'none'; loginWidget.style.display = 'block'; });
        function setCookie(name, value, days) { let expires = ""; if (days) { const date = new Date(); date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000)); expires = "; expires=" + date.toUTCString(); } document.cookie = name + "=" + (value || "") + expires + "; path=/; SameSite=Lax; Secure"; }
        function getCookie(name) { const nameEQ = name + "="; const ca = document.cookie.split(';'); for (let i = 0; i < ca.length; i++) { let c = ca[i]; while (c.charAt(0) === ' ') c = c.substring(1, c.length); if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length); } return null; }
        document.addEventListener('DOMContentLoaded', () => { if (getCookie('session_token')) { window.location.href = LOGGED_IN_PAGE; } });
        const loginForm = document.getElementById('login-form');
        loginForm.addEventListener('submit', async (e) => { e.preventDefault(); const btn = document.getElementById('login-btn'); const msgArea = document.getElementById('login-message'); const username = document.getElementById('login-username').value.trim(); const password = document.getElementById('login-password').value.trim(); if (!username || !password) { msgArea.textContent = 'å…¨é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'; return; } btn.disabled = true; btn.textContent = 'èªè¨¼ä¸­...'; msgArea.textContent = ''; try { const res = await fetch(GAS_WEB_APP_URL, { method: 'POST', mode: 'cors', headers: { 'Content-Type': 'text/plain;charset=utf-8' }, body: JSON.stringify({ action: 'login', username, password }) }); const result = await res.json(); if (result.status === 'success') { setCookie('session_token', result.token, 7); window.location.href = LOGGED_IN_PAGE; } else { msgArea.textContent = result.message || 'ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸã€‚'; } } catch (err) { msgArea.textContent = 'é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'; console.error("Login Error:", err); } finally { btn.disabled = false; btn.textContent = 'ãƒ­ã‚°ã‚¤ãƒ³'; } });
        const registerForm = document.getElementById('register-form');
        registerForm.addEventListener('submit', async (e) => { e.preventDefault(); const btn = document.getElementById('register-btn'); const msgArea = document.getElementById('register-message'); const username = document.getElementById('register-username').value.trim(); const password = document.getElementById('register-password').value.trim(); if (username.length < 4 || username.length > 32 || password.length < 8 || password.length > 32) { msgArea.className = 'message-area error-message'; msgArea.textContent = 'æ–‡å­—æ•°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚'; return; } btn.disabled = true; btn.textContent = 'ç™»éŒ²ä¸­...'; msgArea.textContent = ''; try { const res = await fetch(GAS_WEB_APP_URL, { method: 'POST', mode: 'cors', headers: { 'Content-Type': 'text/plain;charset=utf-8' }, body: JSON.stringify({ action: 'register', username, password }) }); const result = await res.json(); if (result.status === 'success') { setCookie('session_token', result.token, 7); window.location.href = LOGGED_IN_PAGE; } else { msgArea.className = 'message-area error-message'; msgArea.textContent = result.message || 'ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸã€‚'; } } catch (err) { msgArea.className = 'message-area error-message'; msgArea.textContent = 'é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'; console.error("Registration Error:", err); } finally { btn.disabled = false; btn.textContent = 'ç™»éŒ²ã™ã‚‹'; } });
        
        /* â–¼â–¼â–¼ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆç”¨ã®JavaScriptã‚’è¿½åŠ  â–¼â–¼â–¼ */
        function setupPasswordToggle(toggleId, inputId) {
            const toggle = document.getElementById(toggleId);
            const input = document.getElementById(inputId);
            if (toggle && input) {
                toggle.addEventListener('click', () => {
                    if (input.type === 'password') {
                        input.type = 'text';
                        toggle.textContent = 'ğŸ™ˆ'; // ã‚¢ã‚¤ã‚³ãƒ³ã‚’å¤‰æ›´
                    } else {
                        input.type = 'password';
                        toggle.textContent = 'ğŸ‘ï¸'; // ã‚¢ã‚¤ã‚³ãƒ³ã‚’å…ƒã«æˆ»ã™
                    }
                });
            }
        }
        setupPasswordToggle('toggle-login-password', 'login-password');
        setupPasswordToggle('toggle-register-password', 'register-password');
    </script>
</body>
</html>